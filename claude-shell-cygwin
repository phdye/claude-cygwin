#!/usr/bin/env python3
"""Improved Cygwin launcher for Claude Shell Connector with timeout fix."""

import sys
import os
from pathlib import Path

# Environment setup for Cygwin
os.environ["PYTHONIOENCODING"] = "utf-8"
os.environ["LC_ALL"] = "C.UTF-8"
os.environ["LANG"] = "C.UTF-8"
os.environ["CYGWIN"] = "nodosfilewarning"

# Add source to Python path
script_dir = Path(__file__).parent.resolve()
src_dir = script_dir / "src"

if src_dir.exists():
    sys.path.insert(0, str(src_dir))
else:
    print(f"❌ Source directory not found: {src_dir}")
    sys.exit(1)

try:
    from claude_shell_connector.cli.main import main
    main()
except ImportError as e:
    print(f"❌ Import error: {e}")
    print("\nQuick fix:")
    print(f"  cd {script_dir}")
    print("  export PYTHONPATH=$(pwd)/src:$PYTHONPATH")
    print("  python -c 'from claude_shell_connector import run_command'")
    sys.exit(1)
except KeyboardInterrupt:
    print("\n❌ Interrupted by user")
    sys.exit(1)
except Exception as e:
    print(f"❌ Error: {e}")
    sys.exit(1)
